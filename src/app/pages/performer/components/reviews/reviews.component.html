<div class="container" *ngIf='reviews && reviews.length'>

    <mat-icon [ngStyle]="{transform: openCloseComponent ? 'rotate(180deg)' : 'none'}" class="arrow">keyboard_arrow_down</mat-icon>

    <div class="header" (click)="openCloseComponent = !openCloseComponent">
        <p>Отзывы <span>({{reviews.length}})</span></p>
    </div>

    <div class="open-close-component" *ngIf="openCloseComponent">
        <div class="statistics">
            <svg width="100%" height="100%" viewBox="0 0 45 45" class="donut">
                <circle class="donut-hole" cx="21" cy="24" r="15.91549430918954" fill="#fff"></circle>
                <circle class="donut-ring" cx="21" cy="24" r="15.91549430918954" fill="transparent" stroke="#CFE2F9" stroke-width="1.7"></circle>
                <circle class="donut-segment" [ngStyle]="{strokeDasharray: getRatingAllReviews(100).toFixed(0) + ' 100'}" cx="21" cy="21" r="15.91549430918954" fill="transparent" stroke="#0D6FE3" stroke-width="3" stroke-dashoffset="0"></circle>
            </svg>

            <div class="statistics-rating-and-based-on-comments">
                <p class="statistics-rating">{{ getRatingAllReviews(5).toFixed(1) || 0 }}</p>
                <p class="based-on-comments">На основании <span>{{ reviews.length }}</span> отзывов</p>
            </div>
    
            <div class="lines">
                <div class="line-block" *ngFor="let wee of wees">
                    <p class="rating-number">{{ wee }}</p>
    
                    <div class="line">
                        <div [ngStyle]="{'width': showPercentInLine(wee) + '%'}" class="fill-line"></div>
                    </div>    
                    <p><span>{{ getAmountOfComments(wee) }}</span> отзывов</p>
                </div>
            </div>
        </div>

        <div class="sort-by">
            <p class="sort-by-p">Сортировать по:</p>

            <label>
                <input (change)="onChangeEvent($event)" type="radio" value='createAt' name="sortByReviews" checked>
                <p>сначала новые</p>
            </label>

            <label>
                <input (change)="onChangeEvent($event)" type="radio" value='desc' name="sortByReviews">
                <p>сначала положительные</p>
            </label>

            <label>
                <input (change)="onChangeEvent($event)" type="radio" value='asc' name="sortByReviews">
                <p>сначала отрицательные</p>
            </label>
        </div>

        <fieldset class="sort-by-mobile">
            <legend>Сортировка</legend>

            <select (change)="onChangeEvent($event)">
                <option value="createAt">Сначала новые</option>
                <option value="desc">Сначала положительные</option>
                <option value="asc">Сначала отрицательные</option>
            </select>
        </fieldset>

        <div class="review" [ngStyle]="{
                'border-color': getReviewBorderColor(review.rating),
                'background': getReviewBackground(review.rating)}"
                *ngFor="let review of reviews">
            <app-review [review]='review'></app-review>        
        </div>

        <button *ngIf='reviews.length >= 10' class="button-show-more">Показать еще 10 отзывов</button>
    </div>
</div>